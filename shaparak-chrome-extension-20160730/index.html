<!DOCTYPE html>
<html>
<head>
    <link href="http://gmpg.org/xfn/11" rel="profile">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="content-type" content="text/html; charset=utf-8">

<!-- Enable responsiveness on mobile devices-->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

    <title>چرا اکستنشن شاپرک را نوشتم؟ +‌جواب سوالات متداول! - Ali Borhani</title>

<link rel="alternate" type="application/rss+xml" title="RSS"
      href="/feed.rss">

<!-- twitter -->
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@aliborhani1">
<meta name="twitter:creator" content="@aliborhani1">

	<meta name="twitter:title" content="چرا اکستنشن شاپرک را نوشتم؟ +‌جواب سوالات متداول! - Ali Borhani">

<meta name="twitter:url" content="/shaparak-chrome-extension-20160730">

    <meta name="twitter:description" content="چند روز پیش، یک اکستنشن ساده کروم برای بررسی دروازه های پرداخت شاپرک نوشتم و در استور کروم منتشر کردم. اما اینکه چرا اینکار را کردم یا اصلا کاربردی دارد و یا قصد من جاسوسی اطلاعات (!) هست یا نه، باعث شد این پست را بنویسم.">

    <meta name="twitter:image" content="https://borhani.pw/assets/images/2016-07-30-shaparak-verifier.jpg">

<!-- CSS -->
<link rel="stylesheet" href="/assets/css/all.css">


<!-- Icons -->
<link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon">
</head>

<body class="theme-base-08 layout-reverse">

<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-73280108-1', 'auto');
    ga('send', 'pageview');

</script>

<!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
    <div class="sidebar-item">
        <p>علی برهانی
<br>
گاه‌نوشته‌های یک توسعه‌دهنده!</p>
    </div>

    <nav class="sidebar-nav">
        <a class="sidebar-nav-item
                        " href="/">Home</a>
        <a class="sidebar-nav-item" href="http://twitter.com/aliborhani1">Twitter</a>
        <a class="sidebar-nav-item" href="http://github.com/alibo">Github</a>
    </nav>

    <div class="sidebar-item">
        <p>
            &copy; 2016. All rights reserved.
        </p>
    </div>
</div>

<!-- Wrap is the content to shift when toggling the sidebar. We wrap the
     content to avoid any CSS collisions with our real content. -->
<div class="wrap">
    <div class="masthead">
        <div class="container">
            <h3 class="masthead-title">
                <a href="/" title="Home">Ali Borhani</a> -
                <small>گاه&zwnj;نوشته&zwnj;های یک توسعه&zwnj;دهنده!</small>
            </h3>
        </div>
    </div>

    <div class="container content">
            <div class="post">
        <h1 class="post-title">چرا اکستنشن شاپرک را نوشتم؟ +‌جواب سوالات متداول!</h1>
        <span class="post-date"></span>
                    <p><img src="/assets/images/2016-07-30-shaparak-verifier.jpg" alt="Shaparak Verifier - Chrome Extension" /></p>
<p>چند روز پیش، یک اکستنشن ساده کروم برای بررسی دروازه های پرداخت شاپرک نوشتم و <a href="https://chrome.google.com/webstore/detail/shaparak-verifier/npigckpiilmfjkgngcffloobgehgmfme?hl=en-US">در استور کروم منتشر کردم</a>.
اما اینکه چرا اینکار را کردم یا اصلا کاربردی دارد و یا قصد من جاسوسی اطلاعات (!) هست یا نه، باعث شد این پست را بنویسم.</p>
<!-- more -->
<h3>چه اتفاقی افتاد؟</h3>
<p>یک ماه پیش، یکی از دوستانم به من خبر داد که شخصی اپلیکیشن غیر رسمی فروشگاهش  را  برای اندروید در کانال ها و گروه‌های تلگرام منتشر کرده و هنگام پرداخت دروازه پرداخت جعلی را به کاربر نشان می‌دهد.</p>
<p><img src="/assets/images/2016-07-30-fake-mellat-.jpg" alt="صفحه جعلی دروازه پرداخت بانک ملت" />
<em>صفحه‌ی جعلی بانک ملت - این صفحه در اپلیکیشن لود می شده و url آن برای کاربر مشخص نبوده است!</em></p>
<p>بعد از آن به من خبر داد که بعضی از مشتریانش فریب آن را خورده اند و از آنجایی که  شماره تماس دوستم را در اپلیکیشن گذاشته است! چند نفر تماس گرفته اند و شاکی شده اند!
بعد از پیگیری های دوستم از طریق پلیس فتا،‌ وبسایت شخص از طریق میزبان ایرانی آن مسدود شد!</p>
<p><img src="/assets/images/2016-07-30-suspended-.jpg" alt="مسدود شدن سایت جعلی توسط هاستینگ" />
<em>مسدود شدن سایت جعلی توسط هاستینگ</em></p>
<p>هفته بعد از این ماجرا، دوباره اپ جدیدی منتشر شد توسط همان شخص! روز از نو روزی از نو!
اینبار پیگیری ها جدی تر شد و من در توییتر نیز منتشر کردم (<a href="https://twitter.com/aliborhani1/status/748904635579138048">اینجا</a>) . سایت شخص به سرعت مسدود شد و دیروز از دوستم پرسیدم انگار شخصی که فیشینگ کرده بود را هم گرفته‌اند!</p>
<p>همان هفته اول با یکی دیگر از دوستانم هم صحبت کردم برای راه حل جلوگیری از این حملات، به این نتیجه رسیدیم که اکستنشن برای مرورگر می تواند کمکی کند و نوشتن این اکستنشن تا چند روز پیش در لیست todo من وجود داشت!</p>
<h3>فیشینگ دیگری در راه هست!</h3>
<p>چند روز پیش میلاد اسلامی زاد توییتی ارسال کرد که شخصی به بهانه فروش اطلاعات درز کرده ایرانسل یک صفحه جعلی دروازه پرداخت بانک پارسیان را ساخته و کاربران را فریب می دهد!</p>
<blockquote class="twitter-tweet" data-lang="en"><p lang="fa" dir="rtl">اين سايت فيشينگ رو چطوري ميشه به مقامات ريپورت كرد؟ <a href="https://t.co/xap3gKigLq">pic.twitter.com/xap3gKigLq</a></p>&mdash; Milad Islamizad (@islamizad) <a href="https://twitter.com/islamizad/status/758173118179532800">July 27, 2016</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
<h3>Shut Up and do the Work</h3>
<p>این عنوان پادکستی هست که jeffrey way هفته پیش منتشر کرده بود! من هم دقیقا کاری را کردم که گفته!</p>
<p><img src="/assets/images/2016-07-30-shutup-and-do-the-work.jpg" alt="Shut Up and do the Work - Jeffrey way" /></p>
<p>اگر چند دقیقه وقت دارید، پیشنهاد می کنم حتما <a href="https://laracasts.simplecast.fm/35">این پادکست</a> را گوش کنید! شاید دست از پرفکشن و ایده آل گرایی برداریم و چیزها را ساده در نظر بگیریم و شروع کنیم!</p>
<p>خلاصه تمام بهانه های بالا باعث شد که چنین اکستنشنی ساخته شود! (بهانه ها بیشتر از تعداد خط‌های کد آن است!😂)</p>
<h3>این اکستنشن  چه جوری کار می کند؟</h3>
<p>فرآیند این اکستنشن خیلی ساده است، فقط چک می کند که url تبی که در کروم باز کردید اولا ‍‍<code>https‍</code> و ثانیا یکی از ساب دامین های شاپرک باشد:</p>
<pre><code>https://*.shaparak.ir/*</code></pre>
<h3>آیا این اکستنشن صفحات جعلی را نیز تشخیص می دهد؟</h3>
<p>جواب کوتاه: خیر!</p>
<p>این اکستنشن تایید می کند، که صفحه فعلی شما زیرمجموعه شاپرک است یا خیر (حالت برعکس!) ولی توانایی این را ندارد که بررسی کند این صفحه یک صفحه جعلی است! دلیل آن هم روشن است برای اینکار باید روشن کنید که این یک صفحه پرداخت است و این کار ساده ای نیست و راحت فریب می خورد + بررسی تعداد حالت کم (دروازه های شاپرک) خیلی راحت تر از بررسی تماس سایت هاست!
دلیل دیگر هم این هست که کاربر نیازی به این پیچیدگی ندارد! اگر وارد صفحه پرداخت شدید و آیکان اکستنشن فعال نشد، شما متوجه می شوید که این یک صفحه پرداخت جعلی است! به همین سادگی!</p>
<h3>آیا کسی که فریب فیشینگ را می خورد اکستنشن می تواند نصب کند؟!</h3>
<p>بیشترین بازخوردی که به من شد همین بود و تا حدی هم منطقی است! فرآیند نصب اکستنشن برای کاربرای عادی سخت است خصوصا اینکه وب استور کروم هنگام نصب کاربران ایرانی را اذیت می کند و در پنل خود نیز کشور ایران را ندارد!</p>
<p><strong>اما باید این نکته را در نظر داشته باشیم، دلیل اصلی فیشینگ و سایر کلاه برداری های اینترنتی، ناآگاهی مردم می باشد!</strong><br />
اما چه طوری می شود آگاهی مردم را به این مقوله ها زیاد کرد؟ آموزش!</p>
<p>به عنوان مثال من این اکستنشن را برای مرورگر لپ‌تاپ پدر و مادرم نصب کردم و گفتم که اگر این تیک سبز را دیدید آن موقع شروع به وارد کردن اطلاعات حساب کنید! </p>
<h3>خوب خودمان url را چک می کنیم که شاپرک باشد!</h3>
<p>بله قطعا باید url را چک کنید! این به عنوان پیش نیاز  برای هر کاربر اینترنت است! اما کاربران از جمله خود من بعضی مواقع تنبلی می کنیم! یا توسط بعضی از ترفند ها فریب می خوریم!
مثلا:</p>
<pre><code>https://bpm.shaparak.ir.shaparak.xyz</code></pre>
<p>حال اگر اندازه این صفحه را کوچک کنید، اصلا متوجه نمی شوید!</p>
<p><img src="/assets/images/2016-07-30-fake-url.jpg" alt="صفحه جعلی بانک ملت با لینک بالا در حالت اندازه صفحه کوچک" />
<em>صفحه جعلی بانک ملت با لینک بالا در حالت اندازه صفحه کوچک</em></p>
<h3>من به این اکستنشن اعتماد ندارم! از کجا معلوم اطلاعات من را نمی دزد؟!</h3>
<p>این هم از موضوعاتی بود که خیلی از من پرسیده می شد! خصوصا بعد از اینکه امکان نوتیفیکیشن را علیرضا احمدی عزیز برای من <a href="https://github.com/alibo/shaparak-verifier-chrome/pull/1">pull request</a> فرستاد و کروم درخواست فعال سازی دوباره را بعد از آپدیت به کاربر نشان می داد.</p>
<p><strong>این اکستنشن در مرحله اول به صورت متن باز در <a href="https://github.com/alibo/shaparak-verifier-chrome">گیت‌هاب</a> گذاشته شده</strong> و اگر برنامه نویس هستید می توانید کدهای آن را بررسی کنید، حتی می توانید خودتان آن را دانلود کنید، تغییر دهید و به صورت دستی خودتان در کروم نصب کنید.</p>
<p>این اکستنشن نیاز به ۳ تا پرمیشن دارد:</p>
<h4><strong>tabs</strong></h4>
<p>کروم پرمیشن tabs را با جمله <code>Read your browsing historyistory</code> نشان می دهد!  و این به نظر خطرناک می رسد! در واقع این جمله درست است چون شما دسترسی به url هر تب دارید و می توانید آن را جمع آوری کنید!</p>
<p>اما در این اکستنشن چیزی جمع آوری نمی شود بلکه بررسی می شود با عوض شدن و وارد شدن url در هر تب، این url دروازه پرداخت شاپرک است؟ اگر هست آیکان اکستنشن فعال شده و یک تیک سبز رنگ نمایش داده می شود.</p>
<h4><strong>Notification</strong></h4>
<p>برای نمایش نوتیفیکیشن استفاده می شود، در حال حاضر به دلیل نمایش چند باره، این قابلیت غیر فعال است که می توانید در قسمت تنظیمات آن را فعال کنید و هنگام باز شدن سایت هایی که دروازه های پرداخت شتاب هستند،  به شما نوتیفیکیشن نمایش داده شود.</p>
<h4><strong>Storage</strong></h4>
<p>برای ذخیره سازی تنظیمات مانند فعال شدن نمایش نوتیفیکیشن استفاده می شود.</p>
<p>با این حال اگر به این اکستنشن اعتماد ندارید، اصراری بر نصب آن نیست، اما هنگام پرداخت حتما بررسی کنید که url مربوط به شاپرک می باشد :)</p>
<h3>آیا این اکستنشن می‌تواند تمام حمله های فیشینگ شاپرک را دفع کند؟</h3>
<p>جواب کوتاه:‌ خیر!</p>
<p>این اکستنشن فقط برای کروم نوشته شده و اگر کاربر موبایل یا فایرفاکس و یا سایر مرورگرها هستید باید دقت کامل را داشته باشید. <strong>خصوصا در موبایل که بعضی از اپ‌ها به جای فرستادن به مرورگر صفحه پرداخت را درون اپلیکیشن نمایش می دهند و کاربر url آن را نمی بیند!</strong></p>
<p>البته کافه بازار و گوگل پلی قوانین سختی برای این موارد دارند، اگر مورد غیر مجازی دیدید، حتما گزارش دهید :)</p>
<p>در مواردی نیز هم ممکن است url درست باشد اما باز هم صفحه جعلی را مشاهده کنید، این موردی است که یا مرورگر خطای گواهینامه ssl/tls را به شما نشان می دهد که راحت متوجه می شوید.
اما در حالت دیگری که هکر یا یک برنامه مخرب با دسترسی root/admin یک گواهینامه root CA را  به مجموعه گواهینامه های کامپیوتر شما اضافه کرده است، در این مورد شما با خطر جدی طرف هستید و باید با برنامه آنتی ویروس و اینترنت سکیوریتی و ... این رخنه امنیتی را برطرف کنید.</p>
<h3>نتیجه گیری</h3>
<p><strong>هدف من از ساخت این اکستنشن بیشتر بهانه‌ای بود برای جلب کردن توجه کاربران به مقوله فیشینگ و کلاه برداری های اینترنتی، و اینکه بیشتر مراقب باشند و به کاربرانی که آگاهی کمتری دارند هم آموزش دهند!</strong>
خوشبختانه با حمایت های دوستان خصوصا در توییتر، فکر کنم به این هدف رسیدم!</p>
<p><strong>اما صبحتی هم با توسعه دهندگان بانک ها و شاپرک داشتم، اینکه امیدوارم برای تامین امنیت بیشتر فرآیند HPKP را پیاده کنند و شاپرک لیست آدرس دروازه های خود و هش/fingerprint گواهینامه های آن ها را در اختیار عموم قرار دهد. </strong></p>
                </div>

    <section id="disqus_thread"></section>
    </div>
</div>

<label for="sidebar-checkbox" class="sidebar-toggle"></label>
<script src="/assets/js/all.js"></script>
<script type="text/javascript">
    var disqus_shortname = 'alibo';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<script>
    (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
            var target = e.target;

            if(!checkbox.checked ||
                    sidebar.contains(target) ||
                    (target === checkbox || target === toggle)) return;

            checkbox.checked = false;
        }, false);
    })(document);
</script>
</body>
</html>
